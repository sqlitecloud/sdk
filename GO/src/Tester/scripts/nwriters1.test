--set dbname=tester_nwriters1.sqlite
--set n=50
CREATE DATABASE {{.dbname}} IF NOT EXISTS; USE DATABASE {{.dbname}};
--match type is ok
CREATE TABLE IF NOT EXISTS t1(a INTEGER PRIMARY KEY, b); DELETE FROM t1;
--match type is ok

--loop i=1; i<=n; i=i+1;
    --task i NAME insert
        USE DATABASE {{.dbname}}
        INSERT INTO t1 (b) VALUES ({{.i}});
        --dump
        --exit
    --end
--end

--wait all

SELECT * FROM t1;
--dump

UNUSE DATABASE;
--match type is ok

--sleep 100
LIST CONNECTIONS;
-- --match cols 6
LIST DATABASE CONNECTIONS {{.dbname}};
--match rows 0
DROP DATABASE {{.dbname}};
--match type is ok
